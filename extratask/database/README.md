# Основное приложение дополненное базой данных

~~Минимальное работоспособное приложение может хранить все данные в памяти и, соответственно, терять их при перезапуске.~~  
Работоспособное приложение хранит все данные в базе данных ***"H2"*** и, соответственно, не теряет их при перезапуске

## Развёртывание сервера
1. Установить ***jdk*** и ***sbt***
2. Проверить ***Переменные среды*** на наличие путей до папок, в которые установили ***jdk*** и ***sbt***
3. Скачать или склонировать исходники в любую директорию, зайти в ***"maintask"***
3. В консоле выполнить последовательность команд:
~~~
sbt
compile
run
~~~

## Развёртывание сервера базы данных ***"H2"***
При необходимости можно установить консоль для базы данных. Для этого нужно:  
* Скачать установщик или архив с [офф. сайта](https://www.h2database.com/html/main.html)  
* Запустить ***"H2 Console"***  
* В поле *"Класс драйвера"* написать "org.h2.Driver", в поле *"JDBC URL"* - "jdbc:h2:tcp://localhost/~/test", в полях *"Имя пользователя"* и *"Пароль"* - "admin"
* Нажать ***"Соединиться"***

## Rest API
### Добавление телефона в справочник:
~~~
POST /phones/createNewPhone
~~~
Пример запроса
~~~
curl -H "Content-Type: application/json" -d "{ \"name\":\"ilyasviel\", \"number\":\"79xx\" }" -X POST 127.0.0.1:9000/phones/createNewPhone
~~~
### Получение списка ранее добавленных записей в справочник:
~~~
GET /phones
~~~
Пример запроса
~~~
curl -X GET 127.0.0.1:9000/phones
~~~
### Изменение имени или телефона по *id*:
~~~
POST /phone/:id
~~~
Пример запроса
~~~
curl -H "Content-Type: application/json" -d "{\"name\":\"illyasviel\",\"number\":\"79xx\"}" -X POST 127.0.0.1:9000/phone/2
~~~
### Удаление записи по *id*:
~~~
DELETE /phone/:id
~~~
Пример запроса
~~~
curl -X DELETE 127.0.0.1:9000/phone/2
~~~
### Поиск всех вхождений по подстроке имени:
~~~
GET /phones/searchByName
~~~
Пример запроса
~~~
curl -X GET 127.0.0.1:9000:/phones/searchByName?name=illya
~~~
### Поиск всех вхождений по подстроке номера:
~~~
GET /phones/searchByNumber
~~~
Пример запроса
~~~
curl -X GET 127.0.0.1:9000:/phones/searchByNumber?number=7950
~~~
